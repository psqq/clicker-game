{"version":3,"sources":["../src/ui.js","../src/tools.js","../src/world.js","../src/main.js"],"names":["scrollToBottom","el","scrollTop","scrollHeight","clearSelection","document","selection","empty","window","getSelection","sel","removeAllRanges","GameOutput","elSel","querySelector","sep","innerHTML","appendChild","tag","tagEl","createElement","args","join","printEl","GameInput","name","callback","btnEl","classList","add","innerText","onclick","e","addEl","output","tmpOutput","input","doWith","obj","cb","make","Class","Location","nearLocations","Set","Entity","location","addWay","loc1","loc2","homeLocation","loc","streetLocation","player","getPlayerLocation","getNearLocations","getLocationName","movePlayerTo","ui","printTag","nearLocationsButtons","clear","addButton","w","locName","mainButtons"],"mappings":"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","file":"main.da4909e4.js","sourceRoot":"..\\public","sourcesContent":["\r\nfunction scrollToBottom(el) {\r\n    el.scrollTop = el.scrollHeight;\r\n}\r\n\r\nfunction clearSelection() {\r\n    if(document.selection && document.selection.empty) {\r\n        document.selection.empty();\r\n    } else if(window.getSelection) {\r\n        var sel = window.getSelection();\r\n        sel.removeAllRanges();\r\n    }\r\n}\r\n\r\nclass GameOutput {\r\n    constructor(elSel) {\r\n        this.elSel = elSel;\r\n        /** @type {HTMLDivElement} */\r\n        this.el = document.querySelector(elSel);\r\n        this.sep = \"\";\r\n    }\r\n    clear() {\r\n        this.el.innerHTML = '';\r\n    }\r\n    printEl(el) {\r\n        this.el.appendChild(el);\r\n        scrollToBottom(this.el);\r\n    }\r\n    printTag(tag, ...args) {\r\n        const tagEl = document.createElement(tag);\r\n        tagEl.innerHTML = args.join(this.sep);\r\n        this.printEl(tagEl);\r\n    }\r\n}\r\n\r\nclass GameInput {\r\n    constructor(elSel) {\r\n        this.elSel = elSel;\r\n        /** @type {HTMLDivElement} */\r\n        this.el = document.querySelector(elSel);\r\n    }\r\n    clear() {\r\n        this.el.innerHTML = '';\r\n    }\r\n    addEl(el) {\r\n        this.el.appendChild(el);\r\n    }\r\n    addButton(name, callback) {\r\n        const btnEl = document.createElement('span');\r\n        btnEl.classList.add('text-button');\r\n        btnEl.classList.add('no-selection');\r\n        btnEl.innerText = name;\r\n        btnEl.onclick = e => {\r\n            callback(e);\r\n        };\r\n        this.addEl(btnEl);\r\n    }\r\n}\r\n\r\nexport const output = new GameOutput('.output');\r\nexport const tmpOutput = new GameOutput('.tmp-output');\r\nexport const input = new GameInput('.input');\r\n","/**\r\n * @param {T} obj\r\n * @param {(obj: T) => any} cb\r\n * @returns {T}\r\n * @template T\r\n */\r\nexport function doWith(obj, cb) {\r\n    cb(obj);\r\n    return obj;\r\n}\r\n\r\n/**\r\n * @param {new (...arg: any) => T} Class\r\n * @param {(obj: T) => any} cb\r\n * @template T\r\n */\r\nexport function make(Class, cb) {\r\n    let obj = new Class();\r\n    return doWith(obj, cb);\r\n}\r\n","import { make } from \"./tools\";\r\n\r\nclass Location {\r\n    constructor() {\r\n        this.name = \"location\";\r\n        /** @type {Set<Location>} */\r\n        this.nearLocations = new Set();\r\n    }\r\n}\r\n\r\nclass Entity {\r\n    constructor() {\r\n        /** @type {Location} */\r\n        this.location = null;\r\n    }\r\n}\r\n\r\n/**\r\n * @param {Location} loc1 \r\n * @param {Location} loc2 \r\n */\r\nfunction addWay(loc1, loc2) {\r\n    loc1.nearLocations.add(loc2);\r\n    loc2.nearLocations.add(loc1);\r\n}\r\n\r\nconst homeLocation = make(Location, loc => {\r\n    loc.name = \"Дом\";\r\n});\r\n\r\nconst streetLocation = make(Location, loc => {\r\n    loc.name = \"Улица\";\r\n});\r\n\r\naddWay(homeLocation, streetLocation);\r\n\r\nlet player = make(Entity, e => {\r\n    e.location = homeLocation;\r\n});\r\n\r\nexport function getPlayerLocation() {\r\n    return player.location;\r\n}\r\n\r\n/**\r\n * @param {Location} loc\r\n */\r\nexport function getNearLocations(loc) {\r\n    return [...loc.nearLocations];\r\n}\r\n\r\n/**\r\n * @param {Location} loc\r\n */\r\nexport function getLocationName(loc) {\r\n    return loc.name;\r\n}\r\n\r\n/**\r\n * @param {Location} loc\r\n */\r\nexport function movePlayerTo(loc) {\r\n    player.location = loc;\r\n}\r\n","import * as ui from './ui';\r\nimport * as w from './world';\r\n\r\nui.output.printTag('p', 'Добро пожаловать в игру!');\r\n\r\nfunction nearLocationsButtons() {\r\n    ui.input.clear();\r\n    ui.tmpOutput.clear();\r\n    ui.tmpOutput.printTag('p', `Куда?`);\r\n    for(let loc of w.getNearLocations(w.getPlayerLocation())) {\r\n        ui.input.addButton(w.getLocationName(loc), () => {\r\n            w.movePlayerTo(loc);\r\n            const locName = w.getLocationName(loc);\r\n            ui.output.printTag('p', `Вы перешли в локацию: ${locName}`);\r\n            mainButtons();\r\n        });\r\n    }\r\n}\r\n\r\nfunction mainButtons() {\r\n    ui.input.clear();\r\n    ui.tmpOutput.clear();\r\n    ui.input.addButton('Где я?', () => {\r\n        const loc = w.getPlayerLocation();\r\n        const locName = w.getLocationName(loc);\r\n        ui.output.printTag('p', `Текущая локация: ${locName}`);\r\n    });\r\n    ui.input.addButton('Идти', () => {\r\n        nearLocationsButtons();\r\n    });\r\n}\r\n\r\nmainButtons();\r\n"]}